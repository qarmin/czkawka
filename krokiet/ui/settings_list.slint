import { Button, VerticalBox , HorizontalBox, TabWidget, ListView, StandardListView, StandardTableView, CheckBox, ScrollView, LineEdit, SpinBox, ComboBox, TextEdit} from "std-widgets.slint";
import { Settings } from "settings.slint";
import { Callabler } from "callabler.slint";

global SettingsSize {
    out property <length> item_height: 30px;
}

component TextComponent inherits HorizontalLayout {
    in-out property <string> model;
    in property <string> name;
    spacing: 5px;
    Text {
        horizontal-stretch: 0.0;
        vertical-alignment: TextVerticalAlignment.center;
        text: name;
    }
    LineEdit {
        horizontal-stretch: 1.0;
        height: SettingsSize.item_height;
        text: model;
    }
}

component MinMaxSizeComponent inherits HorizontalLayout {
    spacing: 20px;
    Text {
        horizontal-stretch: 0.0;
        text:"Items Size";
        vertical-alignment: TextVerticalAlignment.center;
    }
    HorizontalLayout {
        spacing: 5px;
        horizontal-stretch: 1.0;
        Text {
            text:"Min:";
            vertical-alignment: TextVerticalAlignment.center;
        }
        SpinBox {
            enabled: true;
            height: SettingsSize.item_height;
        }
        Text {
            text:"Max:";
            vertical-alignment: TextVerticalAlignment.center;
        }
        SpinBox {
            enabled: true;
            height: SettingsSize.item_height;
        }
    }
}

component Presets inherits HorizontalLayout {
    spacing: 5px;
    Text {
        text : "Current:";
        vertical-alignment: TextVerticalAlignment.center;
    }
    combo_box := ComboBox {
        current-index <=> Settings.settings_preset_idx;
        model: Settings.settings_presets;
        selected(item) => {
            Callabler.changed_settings_preset(item, self.current_index);
            current_name.text = item;
        }
    }
    current_name := LineEdit {
        text: Settings.settings_presets[0];
    }
    Button {
        text: "Save";
        clicked => {
            Settings.settings_presets[combo_box.current_index] = current_name.text;
            combo_box.current_value = current_name.text;
        }
    }
}

export component SettingsList inherits VerticalLayout {
    preferred-height: 300px;
    preferred-width: 400px;

    Text {
        text: "Settings";
        height: SettingsSize.item_height;
        horizontal-alignment: TextHorizontalAlignment.center;
        font-size: 20px;
    }
    ScrollView {
        VerticalLayout {
            spacing: 5px;
            Presets{
                height: SettingsSize.item_height;
            }
            Text {
                text: "General settings";
                height: SettingsSize.item_height;
                horizontal-alignment: TextHorizontalAlignment.center;
                vertical-alignment: TextVerticalAlignment.center;
            }
            TextComponent {
                name: "Excluded item:";
                model <=> Settings.excluded_items;
            }
            TextComponent {
                name: "Allowed extensions:";
                model <=> Settings.allowed_extensions;
            }
            MinMaxSizeComponent {

            }
        }
    }
}